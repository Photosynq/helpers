function ArrayNth(r,t,n){if(!Array.isArray(r))return null;if((void 0===n||n<0||null===n)&&(n=0),(void 0===t||t<1||null===t)&&(t=1),!Number.isInteger(t))return null;if(!Number.isInteger(n))return null;if(0==r.length&&(t>1||n>0))return null;var a=[];for(i=n;i<r.length;i+=t)a.push(r[i]);return a}function ArrayRange(r,t,n,a){if(void 0===r||"number"!=typeof r)return null;if(void 0===t&&(t=r,r=0),"number"!=typeof t)return null;if(null==n&&(n=1),"number"!=typeof n||0==n)return null;if(void 0===a&&(a="none"),-1==["none","log","ln","x2"].indexOf(a))return null;for(var e=[];n>0?t>r:t<r;)"none"==a&&e.push(r),"log"==a&&e.push(Math.log(r)/Math.LN10),"ln"==a&&e.push(Math.log(r)),"x2"==a&&e.push(Math.pow(r,2)),r+=n;return e}function ArrayUnZip(r){if(void 0===r||0==r.length||!Array.isArray(r)||!Array.isArray(r[0]))return null;for(var t={x:[],y:[]},n=0,a=r.length;n<a;n++)t.x.push(r[n][0]||null),t.y.push(r[n][1]||null);return t}function ArrayZip(r,t){if(void 0===r||void 0===t||!Array.isArray(r)||!Array.isArray(t)||r.length!=t.length)return null;for(var n=[],a=0,e=r.length;a<e;a++)n.push([r[a],t[a]]);return n}function GetIndexByLabel(r,t,n){if(void 0===r)return null;void 0===n&&(n=!1);var a=t.set.map(function(t,n){return t.label==r?n:null}).filter(Number);return 0==a.length?null:1==a.length?n?a:a[0]:a}function GetLabelLookup(r){var t={};if(void 0===r.set)return null;for(var n in r.set)void 0!==r.set[n].label?(void 0===t[r.set[n].label]&&(t[r.set[n].label]=[]),t[r.set[n].label].push(n)):(void 0===t.unknown&&(t.unknown=[]),t.unknown.push(n));return 0==Object.keys(t).length?null:t}function GetProtocolByLabel(r,t,n){if(void 0===r)return null;void 0===n&&(n=!1);var a=t.set.filter(function(t){return t.label==r});return 0==a.length?null:1==a.length?n?a:a[0]:a}function MathLINREG(r,t){var n=!1,a=r.length;if(a==t.length){for(var e=MathSUM(r),o=MathSUM(t),u=0,i=0,s=0,l=0;l<a;l++)i+=r[l]*t[l],u+=r[l]*r[l],s+=t[l]*t[l];var f=(a*i-e*o)/(a*u-e*e),h=(o-f*e)/a,c=(i-1/a*e*o)/Math.sqrt((u-1/a*Math.pow(e,2))*(s-1/a*Math.pow(o,2)));n={m:f,b:h,r:c,r2:c*c}}return n}function MathLN(r){var t=!1;return r&&(t=Math.log(r)),parseFloat(t)}function MathLOG(r){var t=!1;return r&&(t=Math.log(r)/Math.LN10),parseFloat(t)}function MathMAX(r){var t=!1;if(r&&Array.isArray(r))for(i=0;i<r.length;i++){if(!Number(r[i])&&null!==r[i]&&0!=r[i])return parseFloat(Number(r[i]));t?Number(r[i])>t&&(t=Number(r[i])):t=Number(r[i])}return parseFloat(t)}function MathMEAN(r){var t=!1,n=0;if(r&&Array.isArray(r)){for(var a=0,e=r.length;a<e;a++)if(null!==r[a]){if(!Number(r[a])&&null!==r[a]&&0!=r[a])return parseFloat(!Number(r[a]));t+=Number(r[a]),n++}t/=n}return parseFloat(t)}function MathMEDIAN(r){var t=!1;if(r&&Array.isArray(r)){if(r.some(function(r){return!Number(r)&&null!==r&&0!=r}))return parseFloat(t);(r=r.filter(function(r){return!(null===r||!Number(r)&&0!=r)})).sort(function(r,t){return r<t?-1:r>t?1:0});var n=r.length;n%2==0&&(t=(Number(r[n/2-1])+Number(r[n/2]))/2),Math.abs(n)%2==1&&(t=r[Math.floor(n/2)])}return parseFloat(t)}function MathMIN(r){var t=!1;if(r&&Array.isArray(r))for(i=0;i<r.length;i++){if(!Number(r[i])&&null!==r[i]&&0!=r[i])return parseFloat(Number(r[i]));t?Number(r[i])<t&&(t=Number(r[i])):t=Number(r[i])}return parseFloat(t)}function MathROUND(r,t){t=void 0!==t?t:2;var n=!1;return null===r||"object"==typeof r||""===r?parseFloat(n):0==Number(r)?0:(r&&parseInt(t)>=0&&(n=Math.round(Number(r)*Math.pow(10,t))/Math.pow(10,t)),parseFloat(n))}function MathSTDERR(r){var t=!1;if(r&&Array.isArray(r)){if(r.some(function(r){return!Number(r)&&null!==r&&0!=r}))return parseFloat(t);if(r.length>2){for(var n=!1,a=0,e=0,o=r.length;e<o;e++)if(null!==r[e]){if(!Number(r[e])&&null!==r[e]&&0!=r[e])return parseFloat(!Number(r[e]));n+=Number(r[e]),a++}n/=a;var u=[],i=!1;for(e=0,o=r.length;e<o;e++)if(null!==r[e]){var s=Math.pow(r[e]-n,2);i+=s,u.push(s)}stdev=Math.sqrt(i/a),t=stdev/Math.sqrt(a)}}return parseFloat(t)}function MathSTDEV(r){var t=!1;if(r&&Array.isArray(r)){if(r.some(function(r){return!Number(r)&&null!==r&&0!=r}))return parseFloat(t);if((r=r.filter(function(r){return!(null===r||!Number(r)&&0!=r)})).length>2){for(var n=!1,a=0,e=0,o=r.length;e<o;e++)if(null!==r[e]){if(!Number(r[e])&&null!==r[e]&&0!=r[e])return parseFloat(!Number(r[e]));n+=Number(r[e]),a++}n/=a;var u=[],i=!1;for(e=0,o=r.length;e<o;e++){var s=Math.pow(r[e]-n,2);i+=s,u.push(s)}t=Math.sqrt(i/r.length)}}return parseFloat(t)}function MathSTDEVS(r){var t=!1;if(r&&Array.isArray(r)){if(r.some(function(r){return!Number(r)&&null!==r&&0!=r}))return parseFloat(t);if((r=r.filter(function(r){return!(null===r||!Number(r)&&0!=r)})).length>2){for(var n=!1,a=0,e=0,o=r.length;e<o;e++)if(null!==r[e]){if(!Number(r[e])&&null!==r[e]&&0!=r[e])return parseFloat(!Number(r[e]));n+=Number(r[e]),a++}n/=a;var u=[],i=!1;for(e=0,o=r.length;e<o;e++){var s=Math.pow(r[e]-n,2);i+=s,u.push(s)}t=Math.sqrt(i/(r.length-1))}}return parseFloat(t)}function MathSUM(r){var t=!1;if(r&&Array.isArray(r))for(var n=0,a=r.length;n<a;n++)if(null!==r[n]){if(!Number(r[n])&&0!=r[n]){t=!1;break}t+=Number(r[n])}return parseFloat(t)}function MathVARIANCE(r){var t=!1,n=!1,a=0;if(r&&Array.isArray(r)){if(r.some(function(r){return!Number(r)&&null!==r&&0!=r})||0==r.length)return parseFloat(t);for(var e=0,o=(r=r.filter(function(r){return!(null===r||!Number(r)&&0!=r)})).length;e<o;e++)if(null!==r[e]){if(!Number(r[e])&&null!==r[e]&&0!=r[e])return parseFloat(!Number(r[e]));n+=Number(r[e]),a++}for(n/=a,e=0;e<r.length;e++)t+=Math.pow(r[e]-n,2);t=1/(r.length-1)*t}return parseFloat(t)}function info(r,t){void 0===t.messages&&(t.messages={}),void 0===t.messages.info&&(t.messages.info=[]),t.messages.info.push(r)}function warning(r,t){void 0===t.messages&&(t.messages={}),void 0===t.messages.warning&&(t.messages.warning=[]),t.messages.warning.push(r)}function danger(r,t){void 0===t.messages&&(t.messages={}),void 0===t.messages.danger&&(t.messages.danger=[]),t.messages.danger.push(r)}function NonLinearRegression(r,t){var n={iterations:void 0===t.iterations||t.iterations>2e3?200:t.iterations,cPts:r.length||0,cVar:t.variables||1,cPar:t.initial.length||0,equation:t.equation||"",RelaxF:t.RelaxF||1,SEy:t.SEy||1,yTrans:"Y",x1Trans:"X",x2Trans:"X2",x3Trans:"X3",x4Trans:"X4",x5Trans:"X5",x6Trans:"X6",x7Trans:"X7",x8Trans:"X8",Centered:t.Centered||!1,LeastAbs:t.LeastAbs||!1,cPctile:t.Percentile||50},a={ca:t.initial[0]||0,cb:t.initial[1]||0,cc:t.initial[2]||0,cd:t.initial[3]||0,ce:t.initial[4]||0,cf:t.initial[5]||0,cg:t.initial[6]||0,ch:t.initial[7]||0,sa:1,sb:1,sc:1,sd:1,se:1,sf:1,sg:1,sh:1,pva:0,pvb:0,pvc:0,pvd:0,pve:0,pvf:0,pvg:0,pvh:0};function e(r,t){var n=(r=Math.abs(r))/Math.sqrt(t),a=Math.atan(n);if(1==t)return 1-a/(Math.PI/2);var e=Math.sin(a),u=Math.cos(a);return t%2==1?1-(a+e*u*o(u*u,2,t-3,-1))/(Math.PI/2):1-e*o(u*u,1,t-3,-1)}function o(r,t,n,a){for(var e=1,o=e,u=t;u<=n;)o+=e=e*r*u/(u-a),u+=2;return o}function u(r,t){return r>t?r:t}function i(r){var t;return Math.abs(r)<5e-5&&(r=0),(t=(t=r>=0?" "+(r+5e-5):" "+(r-5e-5)).substring(0,t.indexOf(".")+5)).substring(t.length-10,t.length)}function s(r){var t;return Math.abs(r)<5e-7&&(r=0),(t=(t=r>=0?" "+(r+5e-7):" "+(r-5e-7)).substring(0,t.indexOf(".")+7)).substring(t.length-18,t.length)}function l(r,t){return r*(n.cPar+1)+t}var f=[0,0,0,0,0,0,0,0],h=[1,1,1,1,1,1,1,1],c=[0,0,0,0,0,0,0,0,0],p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=[0,0,0,0,0,0,0,0,0],d=0,m=0,b=1,y=0,A=1;function N(r,t,a){r=r;var o=0,N=0,x=0;dgfr=t.cPts-t.cPar;var R=function(r,t){for(var n=.5,a=.5,o=0;a>1e-15;)a/=2,e(o=1/n-1,t)>r?n-=a:n+=a;return o}(.05,dgfr),P=t.cPctile/100,S=a.ca;f[0]=S;var w=a.cb;f[1]=w;var q=a.cc;f[2]=q;var L=a.cd;f[3]=L;var X=a.ce;f[4]=X;var E=a.cf;f[5]=E;var F=a.cg;f[6]=F;var V=a.ch;f[7]=V;var I="Y = "+t.equation+"\n";for(d=1;d<=t.cVar;d++)I+=" x"+d+" ";I+=" Y yc Y-yc SEest YcLo YcHi \n";var C=0;for(Z=0;Z<t.cPar*(t.cPar+1);Z++)p[Z]=0;for(d=1;d<=t.cPts;d++){for(Z=0;Z<t.cVar;Z++)M[Z]=r[d-1][0],v=r[d-1][1];var Q=M[0];"LN(X2)"==t.x1Trans&&(Q=Math.log(M[0])),"SQRT(X2)"==t.x2Trans&&(Q=Math.sqrt(M[0])),"1/X2"==t.x2Trans&&(Q=1/M[0]);var U=Q;M[1];"LN(X2)"==t.x2Trans&&Math.log(M[1]),"SQRT(X2)"==t.x2Trans&&Math.sqrt(M[1]),"1/X2"==t.x2Trans&&1/M[1];M[2];"LN(X3)"==t.x3Trans&&Math.log(M[2]),"SQRT(X3)"==t.x3Trans&&Math.sqrt(M[2]),"1/X3"==t.x3Trans&&1/M[2];M[3];"LN(X4)"==t.x4Trans&&Math.log(M[3]),"SQRT(X4)"==t.x4Trans&&Math.sqrt(M[3]),"1/X4"==t.x4Trans&&1/M[3];M[4];"LN(X5)"==t.x5Trans&&Math.log(M[4]),"SQRT(X5)"==t.x5Trans&&Math.sqrt(M[4]),"1/X5"==t.x5Trans&&1/M[4];M[5];"LN(X6)"==t.x6Trans&&Math.log(M[5]),"SQRT(X6)"==t.x6Trans&&Math.sqrt(M[5]),"1/X6"==t.x6Trans&&1/M[5];M[6];"LN(X7)"==t.x7Trans&&Math.log(M[6]),"SQRT(X7)"==t.x7Trans&&Math.sqrt(M[6]),"1/X7"==t.x7Trans&&1/M[6];M[7];"LN(X8)"==t.x8Trans&&Math.log(M[7]),"SQRT(X8)"==t.x8Trans&&Math.sqrt(M[7]),"1/X8"==t.x8Trans&&1/M[7];var G=T(t.equation,S,w,q,L,X,E,F,V,Q,U);if(Y=r[d-1][1],"Rep"==t.SEy){var _=Y,k=Y*Y;1,_+=Y,k+=Y*Y,Y=_/2;var D=Math.sqrt(Math.abs(k/2-Y*Y)/2)}yo=Y;var O=1;"w"==t.SEy&&(O=v),"Rep"==t.SEy&&(O=D),"Sqrt(Y)"==t.SEy&&(O=Math.sqrt(Y)),0==O&&(O=.001);var j=t.yTrans.toUpperCase(),B=Y;"LN(Y)"==j&&(B=Math.log(Y)),"LN(SQRT)"==j&&(B=Math.sqrt(Y)),"1/Y"==j&&(B=1/Y),"LN(Y)"==j&&(O/=Y),"SQRT(Y)"==j&&(O/=B),"1/Y"==j&&(O=O/Y*Y),Y=B,t.LeastAbs&&(O*=Y<G?u(Math.sqrt(P*Math.abs(Y-G)),.001*Y):u(Math.sqrt((1-P)*Math.abs(Y-G)),.001*Y)),o+=1/(O*O),N+=G/(O*O),x+=(Y-y)*(Y-y)/(O*O);for(var Z=0;Z<t.cPar;Z++){var z=f[Z];if(0==f[Z])var H=1e-4;else H=f[Z]/1e3;f[Z]+=H,S=f[0],w=f[1],q=f[2],L=f[3],X=f[4],E=f[5],F=f[6],V=f[7],ycIncr=T(t.equation,S,w,q,L,X,E,F,V,Q,U),c[Z]=(ycIncr-G)/(H*O),t.Centered&&(f[Z]-=H,S=f[0],w=f[1],q=f[2],L=f[3],X=f[4],E=f[5],F=f[6],V=f[7],ycDecr=T(t.equation,S,w,q,L,X,E,F,V,Q,U),c[Z]=(ycIncr-ycDecr)/(2*H*O)),f[Z]=z,S=f[0],w=f[1],q=f[2],L=f[3],X=f[4],E=f[5],F=f[6],V=f[7]}for(c[t.cPar]=(Y-G)/O,C+=c[t.cPar]*c[t.cPar],Z=0;Z<t.cPar;Z++)for(m=0;m<=t.cPar;m++)p[l(Z,m)]=p[l(Z,m)]+c[Z]*c[m];var J=0;for(Z=0;Z<t.cPar;Z++)for(J+=g[l(Z,Z)]*c[Z]*c[Z],m=Z+1;m<t.cPar;m++)J+=2*g[l(Z,m)]*c[Z]*c[m];var K=G,W=G-R*(J=O*Math.sqrt(J)),$=G+R*J;"LN(Y)"==j&&(K=Math.exp(G),W=Math.exp(W),$=Math.exp($)),"SQRT(Y)"==j&&(K=G*G,W*=W,$*=$),"1/Y"==j&&(K=1/G,W=1/W,$=1/$),I+=i(yo)+i(K)+i(yo-K)+i(J)+i(W)+i($)+"\n"}y=N/(b=o);var rr=((A=x/b)-C/b)/A;for(I+="\nCorr. Coeff. = "+s(Math.sqrt(rr))+"; r*r = "+s(rr),RMS=Math.sqrt(C/u(1,dgfr)),I+="\nRMS Error = "+s(RMS)+"; d.f = "+dgfr+"; SSq = "+s(C)+"\n",AIC=t.cPts*Math.log(C/t.cPts)+2*(t.cPar+1),t.cPts>=t.cPar+2?AICc=AIC+2*(t.cPar+1)*(t.cPar+1+1)/(t.cPts-(t.cPar+1)-1):AICc=AIC,I+="AIC = "+s(AIC)+"; AIC(corrected) = "+s(AICc)+"\n",d=0;d<t.cPar;d++){var tr=p[l(d,d)];for(p[l(d,d)]=1,m=0;m<=t.cPar;m++)p[l(d,m)]=p[l(d,m)]/tr;for(Z=0;Z<t.cPar;Z++)if(d!=Z)for(tr=p[l(Z,d)],p[l(Z,d)]=0,m=0;m<=t.cPar;m++)p[l(Z,m)]=p[l(Z,m)]-tr*p[l(d,m)]}var nr="\nParameter Estimates...\n",ar=[];for(d=0;d<t.cPar;d++)f[d]=f[d]+t.RelaxF*p[l(d,t.cPar)],h[d]=RMS*Math.sqrt(p[l(d,d)]),nr+="p"+(d+1)+"="+s(f[d])+" +/- "+s(h[d])+"; p="+i(e(f[d]/h[d],dgfr))+"\n",ar.push({name:"P"+(d+1),value:f[d],sd_error:h[d],p:e(f[d]/h[d],dgfr)});var er="\nCovariance Matrix Terms and Error-Correlations...\n";for(Z=0;Z<t.cPar;Z++)for(m=Z;m<t.cPar;m++)g[l(Z,m)]=p[l(Z,m)]*RMS*RMS,v=p[l(Z,m)]/Math.sqrt(p[l(Z,Z)]*p[l(m,m)]),er+="B("+(Z+1)+","+(m+1)+")=",Z!=m&&(er+="B("+(m+1)+","+(Z+1)+")="),er+=" ",er+=g[l(Z,m)],er+="; r="+v+"\n";return{text:I,ParameterEstimates:nr,CovarianceMatrix:er,r2:s(rr),par:{ca:f[0],sa:h[0],pva:s(e(f[0]/h[0],dgfr)),cb:f[1],sb:h[1],pvb:s(e(f[1]/h[1],dgfr)),cc:f[2],sc:h[2],pvc:s(e(f[2]/h[2],dgfr)),cd:f[3],sd:h[3],pvd:s(e(f[3]/h[3],dgfr)),ce:f[4],se:h[4],pve:s(e(f[4]/h[4],dgfr)),cf:f[5],sf:h[5],pvf:s(e(f[5]/h[5],dgfr)),cg:f[6],sg:h[6],pvg:s(e(f[6]/h[6],dgfr)),ch:f[7],sh:h[7],pvh:s(e(f[7]/h[7],dgfr))},parameters:ar,RMS_error:RMS,presets:n}}function T(r,t,n,a,e,o,u,i,s,l,f){if("b + a * e(- x / c)"==r)return n+t*Math.exp(-l/a);if("( a - c ) * e( - b * t ) + c"==r)return(t-a)*Math.exp(-n*f)+a;if("( c + a / ( 1 + b / x ) )"==r)return a+t/(1+n/l);if("( c + a * a / ( 1 + b / x ) )"==r)return a+t*t/(1+n/l);if("function"==typeof r){var h=r.toString().match(/function\s{0,}.*?\(([^)]*)\)/)[1];h=h.split(",").map(function(r){return r.replace(/\/\*.*\*\//,"").trim()}).filter(function(r){return r});var c=[];for(var v in h)"a"==h[v]&&c.push(t),"b"==h[v]&&c.push(n),"c"==h[v]&&c.push(a),"d"==h[v]&&c.push(e),"e"==h[v]&&c.push(o),"f"==h[v]&&c.push(u),"g"==h[v]&&c.push(i),"h"==h[v]&&c.push(s),"x"==h[v]&&c.push(l),"t"==h[v]&&c.push(f);return r.apply(null,c)}return null}var x,R={},P=[];for(it=0;it<n.iterations;it++){var S=N(r,n,a);if(x<=S.RMS_error&&it>1||isNaN(S.RMS_error))break;a=S.par,x=S.RMS_error,R=S,P.push(S.RMS_error)}return R.iterations=it,R.RMS_errors=P,delete R.par,R}function TransformTrace(r,t,n){var a=[];if(void 0===r||-1==["add","subtract","multiply","divide","+","-","*","/","normToMin","normToMax","normToRange","normToIdx","normToVal","ma","sgf","abs"].indexOf(r)||void 0===t||!Array.isArray(t))return"Unknown Function";if(void 0!==n&&Array.isArray(n)&&t.length!=n.length)return"Arrays have different sizes (a1 = "+t.length+", a2 = "+n.length+")";if(void 0!==n&&!Array.isArray(n)&&"number"!=typeof n)return"Input for third parameter needs to be an array or number";if("number"==typeof n)a=t.map(function(a){return"add"==r||"+"==r?a+n:"subtract"==r||"-"==r?a-n:"multiply"==r||"*"==r?a*n:"divide"==r||"/"==r||"normToVal"==r?a/n:"normToIdx"==r?a/t[n]:"abs"==r?-Math.log(a/n)/Math.LN10:void 0});else if(void 0===n){if("normToMin"==r){var e=Math.min.apply(Math,t);a=t.map(function(r){return r/e})}if("normToMax"==r){var o=Math.max.apply(Math,t);a=t.map(function(r){return r/o})}if("normToRange"==r){e=Math.min.apply(Math,t),o=Math.max.apply(Math,t);a=t.map(function(r){return(r-e)/(o-e)})}if("ma"==r){var u=[];t.unshift(t[0]),t.push(t[t.length-1]);for(var i=1,s=t.length;i<s-1;i++)u.push((t[i]+t[i-1]+t[i+1])/3);a=u}if("sgf"==r){s=t.length;var l=t[0],f=t[1],h=t[2],c=t[s-1],v=t[s-2],p=t[s-3];u=[];t.unshift(h,f,l),t.push(c,v,p);for(i=3;i<s-3;i++)u.push((-2*t[i-3]+3*t[i-2]+6*t[i-1]+7*t[i]+6*t[i+1]+3*t[i+2]+-2*t[i+2])/21);a=u}if("abs"==r)for(var i in t)a.push(-Math.log(t[i]/t[0])/Math.LN10)}else if("string"==typeof n)a=t.map(function(t){return"add"==r||"+"==r?t+n:"subtract"==r||"-"==r?t-n:"multiply"==r||"*"==r?t*n:"divide"==r||"/"==r?t/n:void 0});else{if(!Array.isArray(n))return null;for(var i in t)"add"!=r&&"+"!=r||a.push(t[i]+n[i]),"subtract"!=r&&"-"!=r||a.push(t[i]-n[i]),"multiply"!=r&&"-"!=r||a.push(t[i]*n[i]),"divide"!=r&&"/"!=r||a.push(t[i]/n[i])}return a}function MathMULTREG(r){if(void 0===r||!Array.isArray(r))return null;for(var t=r[0].length-1,n=[],a=0;a<r[0].length;a++){for(var e=[],o=0;o<r.length;o++)e.push(r[o][a]);n.push(e)}var u=[],i=[];for(a=0;a<n[0].length;a++)i.push(1);u.push(i);var s=[];for(a=0;a<t;a++)u.push(n[a]),s.push(n[a]);var l=n[t],f=QRDecomp(u=transpose(u)),h=dot(inv(f.R),dot(transpose(f.Q),l)),c=0;for(a=0;a<l.length;a++)c+=l[a];var v=c/l.length,p=[];for(a=0;a<l.length;a++){var g=0;for(o=0;o<t;o++)g+=h[o+1]*u[a][o+1];g+=h[0],p.push(g)}var M=0,d=0;for(a=0;a<l.length;a++)M+=(p[a]-v)*(p[a]-v),d+=(l[a]-v)*(l[a]-v);return{rsquared:M/d,slopes:h,points:[s,p]}}function MathEXPINVREG(r){if(void 0===r||!Array.isArray(r))return null;var t=[];for(u=0;u<r.length;u++)t.push(r[u][1]);var n=0,a=0;for(u=0;u<t.length-1;u++)n+=p=(t[u]+t[u+1])/2,a+=p=(Math.pow(t[u],2)+Math.pow(t[u+1],2))/2;for(var e=(a-n*(t[0]+t[t.length-1])/2)/(n-t.length*(t[0]+t[t.length-1])/2),o=clone(r),u=0;u<r.length;u++)(p=r[u][1]-e)<0&&(p*=-1),o[u][1]=MathLN(p);var i,s,l,f=[.5],h=50;for(u=0;u<10;u++){if(h<2){s=-999999,l=0;break}i=h;var c=MathMULTREG(o.slice(0,h));h=MathROUND(-1/c.slopes[1]*f[0],0),9==u&&(h=h>i?h:i,c=MathMULTREG(o.slice(0,h))),s=c.slopes[1],l=Math.pow(Math.E,c.slopes[0])}var v=[];for(u=0;u<r.length;u++){var p=[];p.push(r[u][0]),p.push(l*Math.pow(Math.E,r[u][0]*s)+e),v.push(p)}var g=0;for(u=0;u<r.length;u++)g+=Math.pow(l*Math.pow(Math.E,r[u][0]*s)-r[u][1]+e,2);var M=-1/s,d=-1*l*s;return{points:v,results:[l,s],error:g/=r.length-1,asymptote:e,rsquared:c.rsquared,lifetime:M,slope:d}}function MathPOLYREG(r,t){for(var n=[],a=0;a<r.length;a++){for(var e=[],o=1;o<t+1;o++)e.push(Math.pow(r[a][0],o));e.push(r[a][1]),n.push(e)}var u=MathMULTREG(n).slopes,i=[],s=0;for(a=0;a<r.length;a++){var l=0;for((e=[]).push(r[a][0]),o=0;o<t+1;o++)l+=Math.pow(r[a][0],t)*u[o];e.push(l),i.push(e),s+=Math.pow(l-r[a][1],2)}return{points:i,slopes:u,error:s/=r.length-1}}function subVV(r,t){for(var n=[],a=0;a<r.length;a++)n.push(r[a]-t[a]);return n}function proj(r,t){for(var n=innerProd(r,r),a=innerProd(r,t),e=[],o=0;o<r.length;o++)e[o]=a/n*r[o];return e}function innerProd(r,t){if(r.length==t.length){for(var n=0,a=0;a<r.length;a++)n+=r[a]*t[a];return n}}function normal(r){for(var t=0,n=0;n<r.length;n++)t+=r[n]*r[n];return t=Math.sqrt(t)}function QRDecomp(r){for(var t=transpose(r),n=[],a=[],e=[],o=[],u=[],i=0;i<t.length;i++){n[i]=[];for(var s=0;s<t[i].length;s++)o[s]=0;for(s=0;s<i;s++){var l=proj(a[s],t[i]);for(c=0;c<l.length;c++)o[c]+=l[c]}for(s=0;s<t[i].length;s++)n[i][s]=t[i][s]-o[s];var f=normal(n[i]);for(a[i]=[],e[i]=[],s=0;s<t[i].length;s++)a[i][s]=n[i][s]/f,e[i][s]=n[i][s]+" / "+f}for(i=0;i<t.length;i++){for(u[i]=[],s=0;s<t[i].length;s++)u[i][s]=0;for(s=0;s<=i;s++)for(var h=innerProd(t[i],a[s]),c=0;c<a[i].length;c++)u[i][c]+=a[s][c]*h}a=transpose(a),e=transpose(e);var v={Q:[]};for(i=0;i<a.length;i++)v.Q[i]=e[i];for(i=0;i<a.length;i++)v.Q[i]=a[i];return v.R=dot(transpose(v.Q),r),v}function transpose(r){var t,n,a,e,o,u=r.length,i=r[0].length,s=new Array(i);for(n=0;n<i;n++)s[n]=new Array(u);for(t=u-1;t>=1;t-=2){for(e=r[t],a=r[t-1],n=i-1;n>=1;--n)(o=s[n])[t]=e[n],o[t-1]=a[n],(o=s[--n])[t]=e[n],o[t-1]=a[n];0===n&&((o=s[0])[t]=e[0],o[t-1]=a[0])}if(0===t){for(a=r[0],n=i-1;n>=1;--n)s[n][0]=a[n],s[--n][0]=a[n];0===n&&(s[0][0]=a[0])}return s}function _getCol(r,t,n){var a;for(a=r.length-1;a>0;--a)n[a]=r[a][t],n[--a]=r[a][t];0===a&&(n[0]=r[0][t])}function dotVV(r,t){var n,a,e=r.length,o=r[e-1]*t[e-1];for(n=e-2;n>=1;n-=2)a=n-1,o+=r[n]*t[n]+r[a]*t[a];return 0===n&&(o+=r[0]*t[0]),o}function dotMMbig(r,t){var n,a,e,o=_getCol,u=t.length,i=new Array(u),s=r.length,l=t[0].length,f=new Array(s),h=dotVV;for(--u,a=--s;-1!==a;--a)f[a]=new Array(l);for(a=--l;-1!==a;--a)for(o(t,a,i),e=s;-1!==e;--e)n=r[e],f[e][a]=h(n,i);return f}function _dim(r){for(var t=[];"object"==typeof r;)t.push(r.length),r=r[0];return t}function dim(r){var t;return"object"==typeof r?"object"==typeof(t=r[0])?"object"==typeof t[0]?_dim(r):[r.length,t.length]:[r.length]:[]}function clone(r){for(var t=[],n=0;n<r.length;n++){for(var a=[],e=0;e<r[0].length;e++)a.push(r[n][e]);t.push(a)}return t}function diag(r){var t,n,a,e,o=r.length,u=new Array(o);for(t=o-1;t>=0;t--){for(e=new Array(o),n=t+2,a=o-1;a>=n;a-=2)e[a]=0,e[a-1]=0;for(a>t&&(e[a]=0),e[t]=r[t],a=t-1;a>=1;a-=2)e[a]=0,e[a-1]=0;0===a&&(e[0]=0),u[t]=e}return u}function rep(r,t,n){void 0===n&&(n=0);var a,e=r[n],o=new Array(e);if(n===r.length-1){for(a=e-2;a>=0;a-=2)o[a+1]=t,o[a]=t;return-1===a&&(o[0]=t),o}for(a=e-1;a>=0;a--)o[a]=rep(r,t,n+1);return o}function identity(r){return diag(rep([r],1))}function inv(r){var t,n,a,e,o,u,i,s=dim(r),l=Math.abs,f=s[0],h=s[1],c=clone(r),v=identity(f);for(u=0;u<h;++u){var p=-1,g=-1;for(o=u;o!==f;++o)(i=l(c[o][u]))>g&&(p=o,g=i);for(n=c[p],c[p]=c[u],c[u]=n,e=v[p],v[p]=v[u],v[u]=e,r=n[u],i=u;i!==h;++i)n[i]/=r;for(i=h-1;-1!==i;--i)e[i]/=r;for(o=f-1;-1!==o;--o)if(o!==u){for(t=c[o],a=v[o],r=t[u],i=u+1;i!==h;++i)t[i]-=n[i]*r;for(i=h-1;i>0;--i)a[i]-=e[i]*r,a[--i]-=e[i]*r;0===i&&(a[0]-=e[0]*r)}}return v}function dotMV(r,t){var n,a=r.length,e=new Array(a),o=dotVV;for(n=a-1;n>=0;n--)e[n]=o(r[n],t);return e}function dotVM(r,t){var n,a,e,o,u,i,s;for(e=r.length,o=t[0].length,u=new Array(o),a=o-1;a>=0;a--){for(i=r[e-1]*t[e-1][a],n=e-2;n>=1;n-=2)s=n-1,i+=r[n]*t[n][a]+r[s]*t[s][a];0===n&&(i+=r[0]*t[0][a]),u[a]=i}return u}function dotMMsmall(r,t){var n,a,e,o,u,i,s,l,f,h,c;for(o=r.length,u=t.length,i=t[0].length,s=new Array(o),n=o-1;n>=0;n--){for(l=new Array(i),f=r[n],e=i-1;e>=0;e--){for(h=f[u-1]*t[u-1][e],a=u-2;a>=1;a-=2)c=a-1,h+=f[a]*t[a][e]+f[c]*t[c][e];0===a&&(h+=f[0]*t[0][e]),l[e]=h}s[n]=l}return s}function mulVS(r,t){for(var n=0;n<r.length;n++)r[n]=r[n]*t;return r}function mulSV(r,t){for(var n=0;n<t.length;n++)t[n]=t[n]*r;return t}function dot(r,t){var n=dim;switch(1e3*n(r).length+n(t).length){case 2002:return t.length<10?dotMMsmall(r,t):dotMMbig(r,t);case 2001:return dotMV(r,t);case 1002:return dotVM(r,t);case 1001:return dotVV(r,t);case 1e3:return mulVS(r,t);case 1:return mulSV(r,t);case 0:return r*t;default:throw new Error("numeric.dot only works on vectors and matrices")}}